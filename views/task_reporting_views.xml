<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ============================================ -->
    <!-- TASK ANALYSIS REPORT -->
    <!-- ============================================ -->
    
    <!-- Pivot View -->
    <record id="view_task_report_pivot" model="ir.ui.view">
        <field name="name">task.report.pivot</field>
        <field name="model">task.report</field>
        <field name="arch" type="xml">
            <pivot string="Task Analysis" sample="1">
                <field name="user_id" type="row"/>
                <field name="stage_id" type="col"/>
                <field name="planned_hours" type="measure"/>
                <field name="effective_hours" type="measure"/>
            </pivot>
        </field>
    </record>

    <!-- Graph View -->
    <record id="view_task_report_graph" model="ir.ui.view">
        <field name="name">task.report.graph</field>
        <field name="model">task.report</field>
        <field name="arch" type="xml">
            <graph string="Task Analysis" type="bar" sample="1">
                <field name="user_id"/>
                <field name="planned_hours" type="measure"/>
                <field name="effective_hours" type="measure"/>
            </graph>
        </field>
    </record>

    <!-- List View -->
    <record id="view_task_report_list" model="ir.ui.view">
        <field name="name">task.report.list</field>
        <field name="model">task.report</field>
        <field name="arch" type="xml">
            <list string="Tasks" create="false" delete="false" sample="1"
                  decoration-danger="is_overdue == True"
                  decoration-success="is_closed == True">
                <field name="task_id" invisible="1"/>
                <field name="name" string="Task"/>
                <field name="subtask_name" optional="show"/>
                <field name="task_type" widget="badge"
                       decoration-info="task_type == 'individual'"
                       decoration-warning="task_type == 'team'"/>
                <field name="user_id"/>
                <field name="team_id" optional="show"/>
                <field name="stage_id"/>
                <field name="priority" widget="priority"/>
                <field name="date"/>
                <field name="planned_hours" widget="float_time" sum="Total"/>
                <field name="effective_hours" widget="float_time" sum="Total"/>
                <field name="remaining_hours" widget="float_time" sum="Total" optional="show"/>
                <field name="total_logged_hours" widget="float_time" sum="Total" optional="show"/>
                <field name="task_performance" widget="badge" optional="show"
                       decoration-success="task_performance == 'over_estimated'"
                       decoration-warning="task_performance == 'on_track'"
                       decoration-danger="task_performance == 'under_estimated'"/>
                <field name="subtask_count" optional="show"/>
                <field name="subtask_completed_count" optional="show"/>
                <field name="is_overdue" invisible="1"/>
                <field name="is_closed" invisible="1"/>
                <button name="action_open_task" type="object" string="Open" icon="fa-external-link" class="btn-link"/>
            </list>
        </field>
    </record>

    <!-- Search View -->
    <record id="view_task_report_search" model="ir.ui.view">
        <field name="name">task.report.search</field>
        <field name="model">task.report</field>
        <field name="arch" type="xml">
            <search string="Task Analysis">
                <!-- Search Fields -->
                <field name="name" string="Task" filter_domain="[('name', 'ilike', self)]"/>
                <field name="subtask_name" string="Subtask" filter_domain="[('subtask_name', 'ilike', self)]"/>
                <field name="user_id"/>
                <field name="team_id"/>
                <field name="stage_id"/>
                <field name="date"/>
                
                <!-- Quick Filters -->
                <filter string="My Tasks" name="my_tasks" domain="[('user_id', '=', uid)]"/>
                <filter string="My Team Tasks" name="my_team" domain="[('team_id.member_ids', 'in', uid)]"/>
                <separator/>
                <filter string="Individual Tasks" name="individual" domain="[('task_type', '=', 'individual')]"/>
                <filter string="Team Tasks" name="team" domain="[('task_type', '=', 'team')]"/>
                <separator/>
                <filter string="Open" name="open" domain="[('is_closed', '=', False)]"/>
                <filter string="Closed" name="closed" domain="[('is_closed', '=', True)]"/>
                <filter string="Overdue" name="overdue" domain="[('is_overdue', '=', True)]"/>
                <separator/>
                <filter string="High Priority" name="high_priority" domain="[('priority', 'in', ['2', '3'])]"/>
                
                <!-- Performance Filters -->
                <separator/>
                <filter string="Over Estimated" name="over_est" domain="[('task_performance', '=', 'over_estimated')]"/>
                <filter string="On Track" name="on_track" domain="[('task_performance', '=', 'on_track')]"/>
                <filter string="Under Estimated" name="under_est" domain="[('task_performance', '=', 'under_estimated')]"/>
                
                <!-- Date Filters -->
                <separator/>
                <filter string="Today" name="today" domain="[('date', '=', context_today().strftime('%Y-%m-%d'))]"/>
                <filter string="This Week" name="this_week"
                        domain="[('date', '&gt;=', (context_today() - relativedelta(weeks=1, weekday=0)).strftime('%Y-%m-%d')),
                                 ('date', '&lt;=', (context_today() + relativedelta(weekday=6)).strftime('%Y-%m-%d'))]"/>
                <filter string="This Month" name="this_month"
                        domain="[('date', '&gt;=', (context_today() - relativedelta(day=1)).strftime('%Y-%m-%d')),
                                 ('date', '&lt;=', (context_today() + relativedelta(day=31)).strftime('%Y-%m-%d'))]"/>
                <filter string="This Year" name="this_year"
                        domain="[('date', '&gt;=', context_today().strftime('%Y-01-01')),
                                 ('date', '&lt;=', context_today().strftime('%Y-12-31'))]"/>
                
                <!-- Group By -->
                <group expand="0" string="Group By">
                    <filter string="Assigned To" name="group_user" context="{'group_by': 'user_id'}"/>
                    <filter string="Team" name="group_team" context="{'group_by': 'team_id'}"/>
                    <filter string="Task" name="group_task" context="{'group_by': 'task_id'}"/>
                    <filter string="Subtask" name="group_subtask" context="{'group_by': 'subtask_id'}"/>
                    <filter string="Task Type" name="group_type" context="{'group_by': 'task_type'}"/>
                    <separator/>
                    <filter string="Stage" name="group_stage" context="{'group_by': 'stage_id'}"/>
                    <filter string="Priority" name="group_priority" context="{'group_by': 'priority'}"/>
                    <filter string="Performance" name="group_perf" context="{'group_by': 'task_performance'}"/>
                    <separator/>
                    <filter string="Date" name="group_date" context="{'group_by': 'date'}"/>
                    <filter string="Month" name="group_month" context="{'group_by': 'date_month'}"/>
                    <filter string="Week" name="group_week" context="{'group_by': 'date_week'}"/>
                    <filter string="Year" name="group_year" context="{'group_by': 'date_year'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Action -->
    <record id="action_task_report" model="ir.actions.act_window">
        <field name="name">üìä Task Analysis</field>
        <field name="res_model">task.report</field>
        <field name="view_mode">pivot,graph,list</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No tasks to analyze yet! 
            </p>
            <p>
                Analyze task workload, time tracking, and performance:
                <br/>‚Ä¢ Planned vs Actual hours
                <br/>‚Ä¢ Task completion status
                <br/>‚Ä¢ Performance indicators
                <br/>‚Ä¢ Team and individual metrics
            </p>
        </field>
    </record>

    <!-- ============================================ -->
    <!-- TIME LOG SUMMARY REPORT -->
    <!-- ============================================ -->

    <!-- Pivot View -->
    <record id="view_timesheet_report_pivot" model="ir.ui.view">
        <field name="name">timesheet.report.pivot</field>
        <field name="model">timesheet.report</field>
        <field name="arch" type="xml">
            <pivot string="Time Log Summary" sample="1">
                <field name="user_id" type="row"/>
                <field name="date_month" type="col"/>
                <field name="planned_hours" type="measure"/>
                <field name="unit_amount" type="measure"/>
            </pivot>
        </field>
    </record>

    <!-- Graph View -->
    <record id="view_timesheet_report_graph" model="ir.ui.view">
        <field name="name">timesheet.report.graph</field>
        <field name="model">timesheet.report</field>
        <field name="arch" type="xml">
            <graph string="Time Log Summary" type="bar" sample="1">
                <field name="user_id"/>
                <field name="planned_hours" type="measure"/>
                <field name="unit_amount" type="measure"/>
            </graph>
        </field>
    </record>

    <!-- List View -->
    <record id="view_timesheet_report_list" model="ir.ui.view">
        <field name="name">timesheet.report.list</field>
        <field name="model">timesheet.report</field>
        <field name="arch" type="xml">
            <list string="Time Logs" create="false" delete="false" sample="1"
                  decoration-success="status == 'done'"
                  decoration-info="status == 'in_review'">
                <field name="date"/>
                <field name="user_id"/>
                <field name="task_name"/>
                <field name="subtask_name"/>
                <field name="status" widget="badge"
                       decoration-success="status == 'done'"
                       decoration-info="status == 'in_review'"
                       decoration-warning="status == 'in_progress'"/>
                <field name="planned_hours" widget="float_time" sum="Total"/>
                <field name="unit_amount" widget="float_time" sum="Total"/>
                <field name="remaining_hours" widget="float_time" sum="Total"
                       decoration-danger="remaining_hours &lt; 0"/>
                <field name="team_id" optional="show"/>
                <field name="task_type" optional="show"/>
                <button name="action_open_task" type="object" string="Open Task" icon="fa-external-link" class="btn-link"/>
            </list>
        </field>
    </record>

    <!-- Search View -->
    <record id="view_timesheet_report_search" model="ir.ui.view">
        <field name="name">timesheet.report.search</field>
        <field name="model">timesheet.report</field>
        <field name="arch" type="xml">
            <search string="Time Log Summary">
                <!-- Search Fields -->
                <field name="user_id"/>
                <field name="task_name"/>
                <field name="subtask_name"/>
                <field name="date"/>
                
                <!-- Quick Filters -->
                <filter string="My Logs" name="my_logs" domain="[('user_id', '=', uid)]"/>
                <separator/>
                <filter string="In Progress" name="in_progress" domain="[('status', '=', 'in_progress')]"/>
                <filter string="In Review" name="in_review" domain="[('status', '=', 'in_review')]"/>
                <filter string="Done" name="done" domain="[('status', '=', 'done')]"/>
                <separator/>
                <filter string="Individual Tasks" name="individual" domain="[('task_type', '=', 'individual')]"/>
                <filter string="Team Tasks" name="team" domain="[('task_type', '=', 'team')]"/>
                
                <!-- Date Filters -->
                <separator/>
                <filter string="Today" name="today" domain="[('date', '=', context_today().strftime('%Y-%m-%d'))]"/>
                <filter string="This Week" name="this_week"
                        domain="[('date', '&gt;=', (context_today() - relativedelta(weeks=1, weekday=0)).strftime('%Y-%m-%d')),
                                 ('date', '&lt;=', (context_today() + relativedelta(weekday=6)).strftime('%Y-%m-%d'))]"/>
                <filter string="This Month" name="this_month"
                        domain="[('date', '&gt;=', (context_today() - relativedelta(day=1)).strftime('%Y-%m-%d')),
                                 ('date', '&lt;=', (context_today() + relativedelta(day=31)).strftime('%Y-%m-%d'))]"/>
                
                <!-- Group By -->
                <group expand="0" string="Group By">
                    <filter string="Employee" name="group_employee" context="{'group_by': 'user_id'}"/>
                    <filter string="Task" name="group_task" context="{'group_by': 'task_id'}"/>
                    <filter string="Subtask" name="group_subtask" context="{'group_by': 'subtask_id'}"/>
                    <filter string="Team" name="group_team" context="{'group_by': 'team_id'}"/>
                    <separator/>
                    <filter string="Status" name="group_status" context="{'group_by': 'status'}"/>
                    <filter string="Task Type" name="group_type" context="{'group_by': 'task_type'}"/>
                    <separator/>
                    <filter string="Date" name="group_date" context="{'group_by': 'date'}"/>
                    <filter string="Month" name="group_month" context="{'group_by': 'date_month'}"/>
                    <filter string="Week" name="group_week" context="{'group_by': 'date_week'}"/>
                    <filter string="Year" name="group_year" context="{'group_by': 'date_year'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Action -->
    <record id="action_timesheet_report" model="ir.actions.act_window">
        <field name="name">‚è±Ô∏è Time Log Summary</field>
        <field name="res_model">timesheet.report</field>
        <field name="view_mode">pivot,graph,list</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No time logs yet!
            </p>
            <p>
                Analyze time logging and workload:
                <br/>‚Ä¢ Planned vs Actual hours per entry
                <br/>‚Ä¢ Time by employee, task, and subtask
                <br/>‚Ä¢ Status tracking
                <br/>‚Ä¢ Daily, weekly, monthly summaries
            </p>
        </field>
    </record>
</odoo>